{% extends "2020/base.html" %}

{% load i18n mezzanine_tags organization_tags staticfiles %}

{% block meta_title %}{% trans "Search Results" %}{% endblock %}

{% block extra_head %}
    <meta name="robots" content="noindex">
{% endblock %}

{% block main %}
    <header class="c-hero c-hero--simple">
        <svg class="c-hero__mask" width="228" height="240" aria-label="Vertigo">
            <use xlink:href="{% static 'img/symbols.svg' %}#symbol-vertigo"/>
        </svg>
        <img src="{% static 'img/home.jpg' %}" alt="" loading="lazy" class="c-hero__picture"/>
        <div class="c-hero__container c-container">
            <form action="{% url 'search' %}" method="get" class="c-hero__search" aria-labelledby="search-title">
                <h1 class="c-hero__title u-hidden-visually" id="search-title">{% trans "Search" %}</h1>
                <div class="c-hero__field c-field">
                    <label for="search-query" class="c-field__label">{% trans "Your search" %}</label>
                    <input id="search-query" name="q" type="search" inputmode="search" placeholder="{% trans 'Exemple : IRCAM' %}" value="{{ request.GET.q }}" required{% if not request.GET.q %} autofocus{% endif %} class="c-field__input">
                    <svg class="c-field__icon" width="16" height="16" aria-hidden="true" focusable="false">
                        <use xlink:href="{% static 'img/symbols.svg' %}#symbol-search"/>
                    </svg>
                    <button type="submit" class="c-field__button c-button c-button--secondary c-button--xlarge">
                        <svg class="c-button__icon" width="16" height="16" aria-label="{% trans 'Search' %}" focusable="false">
                            <use xlink:href="{% static 'img/symbols.svg' %}#symbol-arrow-right"/>
                        </svg>
                    </button>
                </div>
            </form>
        </div>
    </header>

    {% if request.GET.q %}
        {% if results.paginator.count == 0 %}
            <section class="c-container c-container--narrow u-mts u-mtl@medium">
                <div class="c-content u-align-center">
                    <p class="h3">{% trans 'No results were found matching your query.' %}</p>
                </div>
            </section>
        {% else %}
            <section class="c-container u-mtxs u-mt-l@medium">
                <div class="c-gallery">
                    <ul class="c-gallery__items">
                        {% include 'core/inc/cards.html' with concrete_objects=results.object_list %}
                    </ul>
                    {% pagination_for results %}
                </div>
            </section>
        {% endif %}
    {% else %}
        {# TODO @emilie: il faudrait pouvoir remonter les dernières actualités comme sur la home #}
        {% include "home/inc/body.html" %}
    {% endif %}
{% endblock %}
